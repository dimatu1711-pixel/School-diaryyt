alert('Будь ласка, заповніть обовʼязкові поля!');
                return;
            }
            
            // Зберігаємо дані школи
            const schools = JSON.parse(localStorage.getItem('schools')) || [];
            schools.push(schoolData);
            localStorage.setItem('schools', JSON.stringify(schools));
            
            // Створюємо адміністратора школи
            const adminPassword = Math.random().toString(36).slice(-8);
            users[schoolData.email] = {
                password: adminPassword,
                school: schoolData.name,
                role: 'admin'
            };
            localStorage.setItem('schoolUsers', JSON.stringify(users));
            
            alert(`✅ Заклад "${schoolData.name}" успішно зареєстровано!\n\nЛогін: ${schoolData.email}\nПароль: ${adminPassword}\n\nЗбережіть ці дані для входу!`);
            
            openTab('login');
        }

        function sendRecoveryCode() {
            const email = document.getElementById('recovery-email').value;
            const btn = document.getElementById('send-code-btn');
            
            if(!email) {
                alert('Будь ласка, введіть ваш email!');
                return;
            }

            recoveryCode = Math.floor(100000 + Math.random() * 900000).toString();
            
            btn.innerHTML = '<div class="loader"></div>';
            btn.disabled = true;

            emailjs.send("service_ydertiz", "template_recovery", {
                to_email: email,
                КОД_ДОСТУПА: recoveryCode,
                time: "15 хвилин"
            })
            .then(function(response) {
                btn.innerHTML = 'Код відправлено ✓';
                alert('✅ Код успішно відправлено на вашу пошту!');
                document.getElementById('code-section').style.display = 'block';
                
                setTimeout(() => {
                    btn.innerHTML = 'Надіслати код';
                    btn.disabled = false;
                }, 5000);
            }, function(error) {
                btn.innerHTML = 'Надіслати код';
                btn.disabled = false;
                alert('❌ Помилка відправки: ' + JSON.stringify(error));
            });
        }

        function resetPassword() {
            const enteredCode = document.getElementById('recovery-code').value;
            const newPass = document.getElementById('new-password').value;
            const email = document.getElementById('recovery-email').value;
            
            if(enteredCode === recoveryCode && newPass) {
                // Оновлюємо пароль
                if(users[email]) {
                    users[email].password = newPass;
                    localStorage.setItem('schoolUsers', JSON.stringify(users));
                    alert('✅ Пароль успішно змінено!');
                    openTab('login');
                } else {
                    alert('❌ Користувача з таким email не знайдено!');
                }
            } else {
                alert('❌ Невірний код або пароль!');
            }
        }
    </script>
</body>
</html>
